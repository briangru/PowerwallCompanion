<Page
    x:Class="PowerwallCompanion.BatteryInfoPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:PowerwallCompanion"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    xmlns:gauge="using:Syncfusion.UI.Xaml.Gauges"
    xmlns:controls="using:Microsoft.UI.Xaml.Controls"
    xmlns:converters="using:PowerwallCompanion.Converters"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Page.Resources>
        <converters:KilowattHourConverter x:Key="KilowattHourConverter"/>
        <converters:BatteryPercentageConverter x:Key="BatteryPercentageConverter" />
        <converters:BatteryCapacityToBrushConverter x:Key="BatteryCapacityToBrushConverter"/>
    </Page.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <!-- 0: Banner -->
            <RowDefinition Height="30" />
            <RowDefinition Height="*" />

        </Grid.RowDefinitions>

        <Image Source="Assets/TeslaLogo.png" Height="35"  Grid.Row="0"/>

        <controls:ItemsRepeater Grid.Row="1" ItemsSource="{x:Bind ViewModel.BatteryInfos, Mode=OneWay}" HorizontalAlignment="Center">
            <controls:ItemsRepeater.ItemTemplate>
                <DataTemplate>
                    <StackPanel Margin="20" Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center">

                        <StackPanel Margin="20">
                            <Image Source="Assets/StoreLogo.png" HorizontalAlignment="Center" Width="80" />
                            <TextBlock Text="{Binding Name}" HorizontalAlignment="Center" />
                        </StackPanel>

                        

                        <StackPanel Margin="20" Orientation="Vertical" VerticalAlignment="Center">
        
                            <StackPanel HorizontalAlignment="Center" Orientation="Vertical">
                                <TextBlock FontSize="30" Text="Current capacity" Foreground="DimGray"/>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock FontSize="50" Text="{Binding TotalPackEnergy, Converter={StaticResource KilowattHourConverter}, ConverterParameter='2'}"></TextBlock>
                                    <TextBlock FontSize="30" Text=" kWh" Foreground="DimGray" VerticalAlignment="Bottom" Margin="0,0,0,4"/>
                                </StackPanel>
                            </StackPanel>

                        </StackPanel>

                        <StackPanel Margin="20" Orientation="Vertical" VerticalAlignment="Center">

                            <StackPanel HorizontalAlignment="Center" Orientation="Vertical">
                                <TextBlock FontSize="30" Text="% of warranted" Foreground="DimGray"/>
                                <TextBlock FontSize="50" Text="{Binding CurrentCapacityPercent, Converter={StaticResource BatteryPercentageConverter}}" Foreground="{Binding CurrentCapacityPercent, Converter={StaticResource BatteryCapacityToBrushConverter}}"></TextBlock>
                            </StackPanel>

                        </StackPanel>

                        <!--<StackPanel Margin="20" VerticalAlignment="Center">
                            <gauge:SfLinearGauge  HorizontalAlignment="Center" Height="80">

                                <gauge:SfLinearGauge.MainScale>

                                    <gauge:LinearScale    ScaleBarStroke="Blue" MajorTickStroke="Gray" BindRangeStrokeToLabels="True" BindRangeStrokeToTicks="True"
                                       MinorTickStroke="Gray" LabelStroke="#424242" ScaleBarBorderThickness="3"
                                       MinorTickSize="12" LabelSize="15" MajorTickSize="25" Maximum="120"
                                       ScaleBarSize="1" ScaleBarBorderBrush="Gray" MinorTicksPerInterval="1" ScaleBarLength="300" LabelPostfix="%">

                                        <gauge:LinearScale.Ranges>

                                            <gauge:LinearRange StartValue="0" EndValue="70" 
                                                StartWidth="0" EndWidth="0" 
                                                RangeOffset="0" RangeStroke="DarkRed"/>
                                            <gauge:LinearRange StartValue="70" EndValue="90" 
                                                StartWidth="0" EndWidth="0" 
                                                RangeOffset="0" RangeStroke="DarkGoldenrod"/>
                                            <gauge:LinearRange StartValue="90" EndValue="120" 
                                                StartWidth="0" EndWidth="0" 
                                                RangeOffset="0" RangeStroke="DarkGreen"/>

                                            <gauge:LinearRange StartValue="0" EndValue="{Binding CurrentCapacity}"
                                                StartWidth="10" EndWidth="10" 
                                                RangeStroke="Magenta" BorderBrush="Black" BorderThickness="3" RangeOffset="5" />

                                        </gauge:LinearScale.Ranges>

                                    </gauge:LinearScale>

                                </gauge:SfLinearGauge.MainScale>

                            </gauge:SfLinearGauge>
                            <TextBlock HorizontalAlignment="Center" Text="{Binding CapacityMessage}" />

                        </StackPanel>-->

                    </StackPanel>
                    
                </DataTemplate>
            </controls:ItemsRepeater.ItemTemplate>
        </controls:ItemsRepeater>

    </Grid>
</Page>
